# Cyberimmune web-project
  ### Состав команды:
- Елехин Александр - 3 курс ИВТ-22-22
- Георгиев Семен - 3 курс ИВТ-22-22
- Антонов Вадим - 3 курс ИВТ-22-22
- Петров Даниил - 3 курс ИВТ-22-22

## Приложение "SecureVault"

Это веб-приложение, предназначенное для безопасного хранения и управления личными данными пользователей, такими как пароли, номера кредитных карт и личные заметки. Пользователи могут создавать учетные записи, добавлять свои данные в защищенные хранилища и получать к ним доступ с любого устройства.

## Постановка задач 

Задачи проекта:
1. Регистрация и Аутентификация
    Регистрация пользователя: Создание учетной записи с использованием уникального имени пользователя и надежного пароля.
    Двухфакторная аутентификация (2FA): Добавление дополнительного уровня безопасности через SMS, электронную почту или приложение для аутентификации.
    Восстановление пароля: Возможность восстановления забытого пароля через электронную почту или другие методы.

2. Управление данными
    Добавление данных: Пользователи могут добавлять пароли, номера кредитных карт, личные заметки и другие данные в защищенные хранилища.
    Редактирование данных: Возможность изменения и обновления информации в хранилищах.
    Удаление данных: Безопасное удаление данных из хранилищ.
    Категоризация данных: Организация данных по категориям (например, финансы, личные заметки, пароли) для удобства поиска и управления.

3. Безопасность данных
    Шифрование данных: Использование сильного шифрования (например, AES-256) для защиты данных как при хранении, так и при передаче.
    Хранение паролей: Хранение паролей с использованием хеширования и соли (например, bcrypt).
    Резервное копирование и восстановление: Регулярное резервное копирование данных с возможностью восстановления в случае потери.

4. Аутентификация и Авторизация
    Ролевая модель: Определение ролей пользователей (например, администратор, пользователь) с различными уровнями доступа.
    Контроль доступа: Реализация политик доступа на основе ролей для ограничения функциональности приложения.
    Журнал аудита: Ведение журнала действий пользователей для мониторинга и анализа безопасности.

5. Доступность и Производительность
    Масштабируемость: Обеспечение возможности масштабирования приложения для обработки большого количества пользователей и данных.
    Отказоустойчивость: Реализация механизмов отказоустойчивости для минимизации времени простоя.
    Оптимизация производительности: Оптимизация запросов к базе данных, кэширование данных и другие методы для повышения производительности.

6. Уведомления и Оповещения
    Уведомления о входе: Отправка уведомлений пользователям о входе в их учетные записи с незнакомых устройств или местоположений.
    Оповещения о подозрительных действиях: Отправка оповещений администраторам о подозрительных действиях, таких как многократные неудачные попытки входа.

7. Интеграция и Совместимость
    Мультиплатформенность: Обеспечение доступа к приложению с различных устройств (настольные компьютеры, мобильные устройства) и операционных систем.
    API для интеграции: Создание API для интеграции с другими сервисами и приложениями.

8. Поддержка и Обслуживание
    Техническая поддержка: Предоставление пользователям возможности обращаться за помощью в случае возникновения проблем.
    Обновления и исправления: Регулярное обновление приложения с исправлением ошибок и улучшением функциональности.


## Цели безопасности 

Основные цели безопасности приложения:

1. Конфиденциальность данных: Гарантировать, что доступ к пользовательским данным имеют только авторизованные пользователи.
2. Целостность данных: Обеспечить защиту данных от несанкционированных изменений.
3. Доступность системы: Гарантировать постоянный и безопасный доступ к веб-приложению для авторизованных пользователей.
4. Аутентификация и авторизация: Обеспечить надежную систему идентификации пользователей и контроля доступа к различным функциям приложения.

## Модель угроз
![изображение](https://github.com/user-attachments/assets/98453e74-9ee3-4571-ae16-c2d1ddeafc61)

## Модель нарушителей 
![изображение](https://github.com/user-attachments/assets/63731903-3596-4224-bcea-22109aebc9ff)


## Архитектура (до кибериммунизации)
![1](https://github.com/user-attachments/assets/ed96fbb4-f968-4e48-9ac6-45c1376635fd)

Текущая архитектура нашего приложения построена так, чтобы обеспечить безопасное и эффективное взаимодействие пользователей с системой. Сначала идет клиентская часть (Frontend), которая реализована с использованием стандартных технологий — HTML, CSS и JavaScript. Через веб-интерфейс пользователи взаимодействуют с приложением, отправляя запросы на сервер по протоколу HTTPS, что гарантирует безопасную передачу данных. Вся работа с сервером осуществляется через REST API.

На стороне сервера (Backend) у нас используется Node.js в связке с Express.js для обработки всех запросов от клиентов. Сервер выполняет всю бизнес-логику, обрабатывает запросы пользователей, проверяет их данные, взаимодействует с базой данных и отправляет ответы обратно. Важный момент — мы строго следим за безопасностью данных, поэтому любые входящие данные проходят через валидацию и фильтрацию, чтобы предотвратить возможные атаки, такие как SQL-инъекции и XSS. Для этого мы используем параметризованные запросы и проверяем все пользовательские вводы перед их обработкой.

Данные пользователей хранятся в базе данных, и для этого мы выбрали MySQL. Мы используем безопасные методы хранения паролей — не просто хэшируем их, а применяем bcrypt с солью, что делает взлом через радужные таблицы практически невозможным. Кроме того, все конфиденциальные данные шифруются с использованием алгоритма AES, так что даже если злоумышленники получат доступ к базе, расшифровать эти данные без ключей они не смогут.

Для повышения производительности и масштабируемости системы у нас настроен балансировщик нагрузки, который распределяет запросы между несколькими экземплярами серверов. Это позволяет избежать перегрузки одного сервера и эффективно обрабатывать большее количество запросов.



## Потенциальные уязвимости:
1. SQL-инъекция в запросах к базе данных: 
    * Описание: Приложение использует небезопасные методы формирования SQL-запросов, что позволяет злоумышленнику внедрить вредоносный код в запрос.
    * Влияние: Злоумышленник может получить доступ к конфиденциальным данным пользователей, таким как пароли и номера кредитных карт.
2. Межсайтовый скриптинг (XSS) в веб-интерфейсе:
    * Описание: Приложение не экранирует пользовательский ввод, что позволяет злоумышленнику внедрить вредоносный JavaScript-код на страницы сайта.
    * Влияние: Злоумышленник может украсть сессионные куки пользователей, получить доступ к их учетным записям и выполнить действия от их имени.
3. Отсутствие шифрования данных при хранении:
    * Описание: Данные пользователей хранятся в базе данных в незашифрованном виде.
    * Влияние: В случае компрометации базы данных злоумышленник получит неограниченный доступ к конфиденциальным данным всех пользователей.
  
## Сценарии атак нарушаемые ЦБ.
### Положительные сценарии атак (успешная защита)
Сценарий 1: Защита от SQL-инъекций
   - Контекст: Пользователь заполняет форму логина, а злоумышленник пытается внедрить SQL-код вместо имени пользователя, например, `admin'--`, чтобы получить доступ к базе данных.
   - Атака: Злоумышленник вводит в поле логина вредоносный SQL-код, надеясь, что приложение выполнит запрос без дополнительной проверки, что позволит обойти процесс аутентификации.
   - Реакция системы: Приложение использует подготовленные запросы (prepared statements), где параметры запроса передаются отдельно от SQL-кода. Ввод злоумышленника не интерпретируется как SQL-запрос, а обрабатывается как простой текст. Это предотвращает выполнение атаки, и злоумышленник не получает доступ к данным.
   - Результат: Атака не удается, и данные пользователей остаются в безопасности.

Сценарий 2: Защита от межсайтового скриптинга (XSS)
   - Контекст: Злоумышленник пытается внедрить вредоносный JavaScript в поле комментария на странице, чтобы другие пользователи запустили этот скрипт, когда откроют страницу.
   - Атака: В поле для комментариев злоумышленник вставляет код вида: `<script>alert('Ваши данные украдены!')</script>`. Этот скрипт будет выполнен, когда другой пользователь откроет страницу с комментарием.
   - Реакция системы: Приложение использует экранирование ввода. Вся пользовательская информация, включая комментарии, проходит обработку, где опасные символы (например, `<` и `>`) заменяются на безопасные HTML-энкодированные версии, предотвращая выполнение скрипта.
   - Результат: Вместо выполнения вредоносного кода, пользователи видят текст `<script>`, а не выполняемый скрипт, и злоумышленник не может украсть их данные.

Сценарий 3: Шифрование данных при передаче и хранении
   - Контекст: Злоумышленник перехватывает трафик между пользователем и сервером, пытаясь украсть данные при их передаче (например, с использованием атаки "человек посередине" – MITM).
   - Атака: Злоумышленник пытается перехватить сессии, данные для входа или личные данные, наблюдая за трафиком между клиентом и сервером.
   - Реакция системы: Приложение использует TLS/SSL для шифрования всего трафика, передаваемого через HTTPS. Все данные передаются в зашифрованном виде, что делает их непонятными для перехватчика. Дополнительно, все данные, хранимые в базе данных, зашифрованы с использованием алгоритмов шифрования, таких как AES-256.
   - Результат: Злоумышленник может перехватить трафик, но без ключа шифрования данные остаются нечитаемыми. Даже если злоумышленник получит доступ к базе данных, он не сможет прочитать зашифрованные данные.
  
### Негативные сценарии атак (неуспешная защита)
Сценарий 1: Успешная SQL-инъекция
   - Контекст: Злоумышленник пытается получить несанкционированный доступ к данным, вводя SQL-код в поле входа в систему.
   - Атака: В поле для логина злоумышленник вводит `admin'--`, что превращает SQL-запрос на сервере в несанкционированный доступ к данным. Например, исходный запрос выглядит так: `SELECT  FROM users WHERE username = 'admin' AND password = ''`. Злоумышленник использует комментарий (`--`), чтобы игнорировать проверку пароля.
   - Реакция системы: Приложение не использует подготовленные запросы и выполняет запрос к базе данных без проверки или экранирования ввода. Это позволяет злоумышленнику получить доступ к данным пользователей без пароля.
   - Результат: Злоумышленник успешно получает доступ к базе данных, может просматривать, изменять или удалять данные, что приводит к серьезной утечке информации.

Сценарий 2: Успешная XSS-атака
   - Контекст: Пользователь посещает страницу с полем для комментариев, где злоумышленник внедрил вредоносный скрипт.
   - Атака: Злоумышленник вставляет JavaScript-код в комментарий: `<script>document.cookie="SESSION=steal"</script>`. Когда другой пользователь заходит на эту страницу, скрипт выполняется, и сессионные данные этого пользователя отправляются злоумышленнику.
   - Реакция системы: Веб-приложение не проверяет и не экранирует пользовательские данные перед выводом их на страницу. Скрипт выполняется, и данные пользователя оказываются в руках злоумышленника.
   - Результат: Сессионные куки или другие конфиденциальные данные пользователей перехвачены, что позволяет злоумышленнику выполнить действия от имени пользователя, например, зайти в его учетную запись.

Сценарий 3: Утечка данных из-за отсутствия шифрования
   - Контекст: Злоумышленник получает доступ к базе данных веб-приложения (например, через уязвимость или взлом учетных данных администратора базы данных).
   - Атака: Злоумышленник загружает полную копию базы данных, которая содержит конфиденциальные данные пользователей: логины, пароли, номера кредитных карт и другую личную информацию.
   - Реакция системы: Данные хранятся в базе в незашифрованном виде, или пароли хранятся без безопасного хэширования. Злоумышленник может легко прочитать информацию, не требуя дополнительной обработки.
   - Результат: Все данные пользователей оказываются доступны злоумышленнику. Это приводит к компрометации учетных записей, финансовым потерям и возможным юридическим последствиям для компании, обслуживающей приложение.


## Архитектура (после кибериммунизации)
![2](https://github.com/user-attachments/assets/61678196-e9b4-4865-8f73-7a8fa85d9409)
Измененная архитектура приложения:
1. Frontend: Добавлена проверка всех пользовательских данных на наличие скриптов и вредоносных кодов.
2. Backend: Внедрены безопасные методы обработки данных (подготовленные SQL-запросы), защищающие от SQL-инъекций. Добавлена система мониторинга подозрительных действий и попыток взлома.
3. База данных: Внедрено шифрование всех конфиденциальных данных с использованием алгоритмов AES-256. Пароли пользователей хранятся в зашифрованном виде (например, с использованием bcrypt).
4. Безопасная передача данных: Все данные передаются через HTTPS с использованием TLS для защиты от MITM-атак.

## Исправление уязвимостей
 1. Защита от SQL-инъекций
SQL-инъекции происходят, когда злоумышленники вставляют вредоносный SQL-код в запросы к базе данных через форму ввода. Это позволяет получить доступ к данным, изменить их или удалить, что ставит под угрозу всю базу данных. Нужно использовать подготовленные запросы. Они позволяют отделить структуру запроса от данных, передаваемых пользователем. Вместо прямого включения пользовательского ввода в SQL-запрос, в подготовленном запросе сначала создается шаблон с параметрами, а затем данные передаются в эти параметры безопасным способом.  Еще, можно использовать параметризованные запросы. При их использовании все переменные и данные, переданные в SQL, обрабатываются как параметры, а не как часть кода запроса, что и предотвращает возможность манипуляции с SQL-запросами. 

2. Предотвращение уязвимостей межсайтового скриптинга (XSS)
XSS-атаки позволяют злоумышленникам внедрить вредоносные скрипты на веб-страницы, которые могут быть выполнены на стороне клиента, что ведет к краже данных, подмене содержимого страниц и другим негативным последствиям. Для предотвращения XSS используем строгую проверку всех пользовательских вводов. Прежде чем выводить данные, введенные пользователем (например, комментарии или форму обратной связи), необходимо убедиться, что они безопасны. Для этого нужно проверить тип вводимых данных, размер, допустимые символы и другие параметры. Например, для полей, ожидающих текстовые данные, нужно исключить ввод HTML- или JavaScript-кода. Либо использовать контекстно-зависимое экранирование данных при рендеринге в HTML. При выводе данных на страницу важно применять экранирование в зависимости от контекста (HTML, JavaScript, CSS, атрибуты). Это предотвращает интерпретацию пользовательского ввода как кода. В итоге символы `<` и `>` должны быть экранированы как `&lt;` и `&gt;`, чтобы предотвратить создание тегов, которые могут внедрить скрипты. Также вариантом решения будет включение Content Security Policy (CSP): CSP – это HTTP-заголовок, который ограничивает выполнение JavaScript-кода на веб-странице. Он позволяет контролировать источники скриптов, которые могут быть выполнены на странице. С помощью CSP можно запретить выполнение неподписанных или сторонних скриптов, что значительно уменьшает вероятность XSS-атак. Например, можно разрешить выполнение скриптов только с определенных доверенных доменов и запретить инлайн-скрипты.

 3. Реализация шифрования пользовательских данных
Для защиты конфиденциальной информации пользователей, такой как пароли, адреса электронной почты и другая личная информация, важно использовать шифрование данных как при передаче, так и при хранении. Это помогает предотвратить несанкционированный доступ к данным в случае утечки или взлома базы данных.
Используем шифрование конфиденциальных данных. Все чувствительные данные должны быть зашифрованы с использованием современных криптографических алгоритмов, таких как AES (Advanced Encryption Standard). Это обеспечивает защиту данных, даже если они будут перехвачены злоумышленниками. Используем надежный метод хэширования для паролей. Для хранения паролей нельзя использовать простое хэширование или, тем более, хранить пароли в открытом виде. Необходимо использовать специальные алгоритмы хэширования, будем использовать bcrypt, который обеспечивает высокий уровень безопасности. Он создает уникальные хэши даже для одинаковых паролей и добавляет случайные символы, строку к каждому паролю, что делает невозможным использование радужных таблиц для взлома. Передача данных тоже уязвима, поэтому нужна защита при передаче (HTTPS). Все данные, передаваемые между клиентом и сервером, должны быть защищены с использованием SSL/TLS, что обеспечивается через HTTPS. Это предотвращает перехват данных злоумышленниками во время передачи по сети.  



## Список литературы: 
 - https://habr.com/ru/companies/first/articles/709586/
 - https://cwe.mitre.org/
 - https://owasp.org/Top10/
 - https://habr.com/ru/companies/simplepay/articles/258499/
 - https://www.kaspersky.ru/resource-center/definitions/sql-injection
 - https://learn.microsoft.com/ru-ru/sql/relational-databases/security/sql-injection?view=sql-server-ver16
 - https://wiki.rookee.ru/cross-site-scripting/
